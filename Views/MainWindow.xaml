<Window x:Class="BonsaiGotchiGame.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:BonsaiGotchiGame"
        mc:Ignorable="d"
        Title="BonsaiGotchi" Height="700" Width="900"
        WindowStartupLocation="CenterScreen">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Top bar with status and clock -->
        <Border Grid.Row="0" 
                x:Name="HeaderBar"
                Background="#4CAF50" 
                Padding="12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           x:Name="StatusTextBlock"
                           Text="{Binding StatusMessage}" 
                           Foreground="White"
                           FontSize="14" 
                           FontWeight="SemiBold"
                           TextWrapping="Wrap"
                           VerticalAlignment="Center"/>

                <!-- Game Clock Display -->
                <Border Grid.Column="1" 
                        Background="#388E3C" 
                        CornerRadius="6" 
                        Padding="10,6" 
                        Margin="8,0">
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                        <TextBlock Text="{Binding Bonsai.GameTimeDisplay}" 
                                   Foreground="White"
                                   FontSize="14" 
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding Bonsai.GameDateDisplay}" 
                                   Foreground="White"
                                   Opacity="0.8"
                                   FontSize="10"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <Button Grid.Column="2" 
                        Content="âš™ï¸" 
                        Width="34" 
                        Height="34"
                        Margin="5,0,0,0"
                        Click="Settings_Click"
                        Background="#795548"
                        Foreground="White"
                        BorderThickness="0"
                        ToolTip="Settings"/>
            </Grid>
        </Border>

        <!-- Main content area with 3 columns -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <!-- Left: Status bars -->
                <ColumnDefinition Width="*"/>
                <!-- Center: Bonsai sprite -->
                <ColumnDefinition Width="200"/>
                <!-- Right: Action buttons -->
            </Grid.ColumnDefinitions>

            <!-- Left column: Status bars -->
            <Border Grid.Column="0"
                    Background="White"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1"
                    Margin="12,12,12,99">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,0,0,84">
                    <StackPanel Margin="10">
                        <!-- Bonsai Name and Age -->
                        <TextBlock Text="{Binding Bonsai.Name}" 
                                 FontWeight="Bold"
                                 FontSize="18"/>
                        <TextBlock Text="{Binding Bonsai.Age, StringFormat=Age: {0} days}"
                                 Foreground="Gray"
                                 FontSize="14" 
                                 Margin="0,4,0,12"/>

                        <!-- Health Stat -->
                        <Border x:Name="HealthStatPanel"
                                Margin="0,4" 
                                BorderBrush="#E0E0E0" 
                                BorderThickness="1" 
                                Padding="8">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="ðŸŒ¿" FontSize="18" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="Health" Foreground="Gray" FontSize="12" FontWeight="SemiBold"/>
                                    <TextBlock Grid.Column="2" 
                                           Text="{Binding Bonsai.Health, StringFormat={}{0}%}" 
                                           FontWeight="Bold"
                                           FontSize="14"
                                           Margin="0,4"/>
                                </Grid>

                                <ProgressBar x:Name="HealthProgressBar"
                                         Grid.Row="2" 
                                         Value="{Binding Bonsai.Health}" 
                                         Foreground="#4CAF50" 
                                         Maximum="100" 
                                         Height="15"
                                         Margin="0,8,0,0"/>
                            </Grid>
                        </Border>

                        <!-- Water Stat -->
                        <Border x:Name="WaterStatPanel"
                                Margin="0,4" 
                                BorderBrush="#E0E0E0" 
                                BorderThickness="1" 
                                Padding="8">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="ðŸ’§" FontSize="18" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="Water" Foreground="Gray" FontSize="12" FontWeight="SemiBold"/>
                                    <TextBlock Grid.Column="2" 
                                           Text="{Binding Bonsai.Water, StringFormat={}{0}%}" 
                                           FontWeight="Bold"
                                           FontSize="14"
                                           Margin="0,4"/>
                                </Grid>

                                <ProgressBar x:Name="WaterProgressBar"
                                         Grid.Row="2" 
                                         Value="{Binding Bonsai.Water}" 
                                         Foreground="#2196F3" 
                                         Maximum="100" 
                                         Height="15"
                                         Margin="0,8,0,0"/>
                            </Grid>
                        </Border>

                        <!-- Growth Stat -->
                        <Border x:Name="GrowthStatPanel"
                                Margin="0,4" 
                                BorderBrush="#E0E0E0" 
                                BorderThickness="1" 
                                Padding="8">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="ðŸŒ±" FontSize="18" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="Growth" Foreground="Gray" FontSize="12" FontWeight="SemiBold"/>
                                    <TextBlock Grid.Column="2" 
                                           Text="{Binding Bonsai.Growth, StringFormat={}{0}%}" 
                                           FontWeight="Bold"
                                           FontSize="14"
                                           Margin="0,4"/>
                                </Grid>

                                <ProgressBar x:Name="GrowthProgressBar"
                                         Grid.Row="2" 
                                         Value="{Binding Bonsai.Growth}" 
                                         Foreground="#FFC107" 
                                         Maximum="100" 
                                         Height="15"
                                         Margin="0,8,0,0"/>
                            </Grid>
                        </Border>

                        <!-- Energy Stat -->
                        <Border x:Name="EnergyStatPanel"
                                Margin="0,4" 
                                BorderBrush="#E0E0E0" 
                                BorderThickness="1" 
                                Padding="8">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="âœ¨" FontSize="18" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="Energy" Foreground="Gray" FontSize="12" FontWeight="SemiBold"/>
                                    <TextBlock Grid.Column="2" 
                                           Text="{Binding Bonsai.Energy, StringFormat={}{0}%}" 
                                           FontWeight="Bold"
                                           FontSize="14"
                                           Margin="0,4"/>
                                </Grid>

                                <ProgressBar x:Name="EnergyProgressBar"
                                         Grid.Row="2" 
                                         Value="{Binding Bonsai.Energy}" 
                                         Foreground="#FF5722" 
                                         Maximum="100" 
                                         Height="15"
                                         Margin="0,8,0,0"/>
                            </Grid>
                        </Border>

                        <!-- Journal in the status panel -->
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center column: Bonsai sprite display -->
            <Border Grid.Column="1" 
                    x:Name="BonsaiDisplayArea"
                    Background="White"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1"
                    Margin="6,12">
                <!-- ViewBox to scale the 1024x1024 area to fit the window -->
                <Viewbox Stretch="Uniform" Margin="4">
                    <!-- Main container with fixed aspect ratio -->
                    <Grid Width="1024" Height="1024">
                        <!-- Fallback background color -->
                        <Rectangle Fill="#E8F5E9" Width="1024" Height="1024"/>

                        <!-- Background layer that changes with time of day -->
                        <Image x:Name="BackgroundImage"
                               Source="{Binding CurrentBackgroundImage}"
                               Stretch="Fill"
                               Width="1024" 
                               Height="1024"/>

                        <!-- Bonsai sprite layer -->
                        <Canvas Width="512" Height="512">
                            <Image x:Name="BonsaiImage" 
                                   Width="512" 
                                   Height="512"
                                   RenderOptions.BitmapScalingMode="HighQuality"
                                   Canvas.Left="0" 
                                   Canvas.Top="196">
                            </Image>
                        </Canvas>
                    </Grid>
                </Viewbox>
            </Border>

            <!-- Right column: Action buttons -->
            <Border Grid.Column="2"
                    Background="#E8F5E9"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1"
                    Margin="6,12,12,99">
                <StackPanel Margin="10">
                    <TextBlock Text="Actions" 
                               FontSize="18" 
                               FontWeight="Bold" 
                               Margin="0,0,0,12" 
                               HorizontalAlignment="Center"/>

                    <!-- Water Button -->
                    <Button x:Name="WaterButton"
                            Background="#4CAF50"
                            Foreground="White"
                            Height="70" 
                            Margin="0,4,0,16"
                            IsEnabled="{Binding IsInteractionEnabled}"
                            Click="Water_Click"
                            ToolTip="Give your bonsai water to keep it hydrated">
                        <StackPanel>
                            <TextBlock Text="ðŸ’§" FontSize="24" HorizontalAlignment="Center"/>
                            <TextBlock Text="Water" Margin="0,8,0,0" FontSize="14" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Prune Button -->
                    <Button x:Name="PruneButton"
                            Background="#4CAF50"
                            Foreground="White"
                            Height="70" 
                            Margin="0,4,0,16"
                            IsEnabled="{Binding IsInteractionEnabled}"
                            Click="Prune_Click"
                            ToolTip="Prune your bonsai to encourage healthy growth">
                        <StackPanel>
                            <TextBlock Text="âœ‚ï¸" FontSize="24" HorizontalAlignment="Center"/>
                            <TextBlock Text="Prune" Margin="0,8,0,0" FontSize="14" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Rest Button -->
                    <Button x:Name="RestButton"
                            Background="#4CAF50"
                            Foreground="White"
                            Height="70" 
                            Margin="0,4,0,16"
                            IsEnabled="{Binding IsInteractionEnabled}"
                            Click="Rest_Click"
                            ToolTip="Let your bonsai rest to recover energy">
                        <StackPanel>
                            <TextBlock Text="ðŸŒ™" FontSize="24" HorizontalAlignment="Center"/>
                            <TextBlock Text="Rest" Margin="0,8,0,0" FontSize="14" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Fertilize Button -->
                    <Button x:Name="FertilizeButton"
                            Background="#4CAF50"
                            Foreground="White"
                            Height="70" 
                            Margin="0,4,0,16"
                            IsEnabled="{Binding IsInteractionEnabled}"
                            Click="Fertilize_Click"
                            ToolTip="Apply fertilizer to boost growth">
                        <StackPanel>
                            <TextBlock Text="ðŸŒ±" FontSize="24" HorizontalAlignment="Center"/>
                            <TextBlock Text="Fertilize" Margin="0,8,0,0" FontSize="14" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Save Button -->
                    <Button x:Name="SaveButton"
                            Background="#795548"
                            Foreground="White"
                            Height="50" 
                            Margin="0,20,0,0"
                            Padding="0,8"
                            Click="SaveGame_Click">
                        <StackPanel>
                            <TextBlock Text="ðŸ’¾" FontSize="18" HorizontalAlignment="Center"/>
                            <TextBlock Text="Save Game" Margin="0,4,0,0" FontSize="12"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>
            <Expander Header="Bonsai Journal" 
                                  ExpandDirection="Down"
                                  IsExpanded="False"
                                  x:Name="JournalExpander"
                                  Background="#E8F5E9"
                                  BorderBrush="#A5D6A7"
                                  BorderThickness="1" Margin="0,520,0,0" Grid.ColumnSpan="3">
                <Border Background="White" MaxHeight="200">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <ItemsControl x:Name="JournalEntriesList" Margin="8">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" Margin="0,2" TextWrapping="Wrap"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                            <TextBlock Text="[Day 1] Your bonsai was born!" Foreground="#2E7D32"/>
                            <TextBlock Text="[Day 1] You watered your bonsai for the first time." Foreground="#1976D2"/>
                            <TextBlock Text="[Day 2] Your bonsai is growing nicely!" Foreground="#388E3C"/>
                            <TextBlock Text="[Day 3] You applied fertilizer to boost growth." Foreground="#F57C00"/>
                            <TextBlock Text="[Day 4] Your bonsai entered its first bloom cycle!" Foreground="#D81B60"/>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>
            </Expander>
        </Grid>
    </Grid>
</Window>